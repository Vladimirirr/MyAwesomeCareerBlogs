# 关于 C 语言变量声明在其他语句后的一些细节

今天一个同学来找我，说他的代码老是编译不通过，我看了半天，好像都很符合逻辑，但一直显示一个变量未定义，我就纳闷了，代码类似如下：

```c
int main(){
    login();
    int id;
    scanf("%d", &id);
    // ....
}
```

他用的是 VC6，编译器一直提示变量"id"未定义，做了一些猜测性调试，仍是错误，我就凭着感觉把 login;和 int id;互换了个行，发现成功编译，然后他就走了，留下我一个人回想着原来错误的代码在电脑前凌乱，于是就有了下面的发现。

给出如下 C 代码：

```c
int main(){
    int a;
    printf("%d\n", a);
    int b;
    printf("%d,%d\n", a ,b);

    return 1;
}
```

在 VC6 模式下，第 5 行会报错：error C2065: 'b' : undeclared identifier。

结论：这是一个早期的 C 语言规定，在 VC6（即 C90 标准）下，每个块级作用域中的所有变量的声明必须放在最前面，一旦执行任何其他非声明语句之后，后续的任何声明都将错误。C99 之后，此标准被改变，允许在任何需要变量的时候进行声明。

> 2018-07-09
